---
title: "进程管理: ps, kill, top"
---

# ps

使用 `ps` 可以查看当前进程

```shell
ps [-e] [-f]
```

* `-e`：显示所有进程，否则只显示当前用户的进程
* `-f`：以完全格式化的形式展示，显示全部信息
![[Pasted image 20240806165244.png]]

* `UID`：进程所属用户 ID
* `PID`：进程 id
* `PPID`：进程的父进程 id
* `C`：CPU 占用率（百分比）
* `STIME`：进程启动时间
* `TTY`：启动进程的终端号，`?` 表示非终端启动
* `TIME`：进程占用 CPU 时间
* `CMD`：进程的启动路径或启动命令
# kill

向一个进程发送信号，多用于控制进程状态，也可以用于进程间的消息传递

```shell
kill -<signal> <pid>
```

- `pid`：目标进程 id
- `signal`：信号，可以是全称、简称或序号，推荐使用全称
	- 如 `SIGKILL` 简称为 `KILL`，序号为 9，可用于强制结束进程
	- 忽略时，默认为 `SIGTERM`

使用 `kill -l` 可以看到所有信号

```shell
kill -l
```

常用的信号有：

| 信号      | 说明              |
| ------- | --------------- |
| SIGTERM | 省略时的默认信号，终止进程   |
| SIGINT  | 中断进程，相当于 Ctrl+C |
| SIGSTOP | 暂停进程            |
| SIGCONT | 恢复进程            |
| SIGTSTP | 等同于 Ctrl+Z      |
| SIGKILL | 强制杀死进程          |
# top

查看 CPU、内存占用率，默认每 5s 刷新一次

```shell
top [options]
```

* `-p 进程id`：只显示某个进程信息
* `-u 用户`：只显示某个用户的进程信息
* `-d 间隔`：刷新时间，单位 s，默认 5s
* `-c`：COMMAND 列显示产生进程的完整命令，默认进程名
* `-n 次数`：指定刷新次数，刷新 n 次后 top 自动关闭
* `-b`：以非交互模式运行，一般配合 `-n` 将输出重定向到某个文件
* `-i`：不显示闲置和僵尸进程（状态为 I 或 Z）

![[Pasted image 20240806165302.png]]

* 第一行 top - 系统时间 up 系统运行时间, 登录用户数, 系统平均负载: 1min, 5min, 15min
* 第二行 Tasks 总进程数，运行中的进程数，睡眠中的进程数，已停止进程数，僵尸进程数
* 第三行 CPU 使用率
    * **us**，**sy**：用户、系统 CPU 使用率
    * ni：高优先级进程占用 CPU 时间百分比
    * id：空闲 CPU 率
    * wa：IO 等待 CPU 占用率
    * hi，si：CPU 硬件、软件中断率
    * st：强制等待占用 CPU 率
* 第四、五行：内存使用率
    * **Mem**，Swap：物理内存、虚拟内存（交换空间）
    * **total**，**free**，**used**，buffer/cache：总量，空闲，已使用，buffer 和 cache 占用（系统缓存）
* 下方列表：当前进程列表
    * PR：优先级，越小越高
    * NI：以 0 为基准的优先级，正表示低于标准
    * VIRT：使用的虚拟内存，单位 KB
    * RES：使用的物理内存，单位 KB
    * SHR：使用的共享内存，单位 KB
    * S：状态，R 表示运行，S 休眠，Z 僵死，I 空闲，N 负优先级
    * %CPU：CPU 占用率
    * %MEM：内存占用率
    * TIME+：使用 CPU 时间总计，单位 10ms
    * COMMAND：启动命令或程序路径

| 按键  | 作用                     |
| --- | ---------------------- |
| h   | 帮助                     |
| c   | 显示完整命令（开启、关闭 -c 选项）    |
| i   | 不显示无用进程（开启、关闭 -i 选项）   |
| f   | 选择展示项目                 |
| M   | 根据驻留内存排序（%MEM 列）       |
| P   | 根据 CPU 使用率排序（%CPU 列）   |
| T   | 根据运行时间/累计时间排序（TIME+ 列） |
| e   | 切换顶部内存信息使用单位           |
| E   | 切换进程内存信息使用单位           |
| l   | 切换显示平均负载和启动时间          |
| t   | 切换显示 CPU 状态信息          |
| m   | 切换显示内存信息               |
| q   | 退出、返回上层（h、f 等）         |
