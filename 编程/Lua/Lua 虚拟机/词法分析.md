根据语法规则，将源代码（字节流）分解为 Token 流。

词法分析器通过有限状态机 FSM 实现，多依赖于正则。
# Lua 语法单元
## 空白字符

> [!note] 自由格式语言：编译器除换行符用于计算行号外，其他空白字符没有其他含义，只用于分隔 Token

Lua 属于自由格式语言，空白字符包括空格，`\t`，`\n`，`\r`，`\v`，`\f` 6 个字符
## 注释

Lua 编译器会完全忽略注释
- 短注释：`--` 开头到行末
- 长注释：`--[<...>[]<...>]`，可跨多行，两个 `<...>` 块相同，如 `--[===[]===]` 等
## 标识符

命名变量，包括数字、大小写、下划线，不能以数字开头，大小写敏感

> [!attention] 应避免使用以 `_` +大写字母开头的标识符
## 关键字

不能作为标识符使用，Lua 包含 22 个关键字
## 数字字面量

十进制：只包含数字，最多一个小数点和 `e/E`，以数字或小数点开头，使用 `e/En{n}` 表示科学计数法
十六进制：多一个 `0x` / `0X` 开头，科学计数法使用 `p/P` 而非 `e` 表示

```go
var reNumber = 
  regexp.MustCompile(`^0[xX][0-9a-fA-F]*(\.[0-9a-fA-F]*)?([pP][+\-]?[0-9]+)?|^[0-9]*(\.[0-9]*)?([eE][+\-]?[0-9]+)?`)
```
## 字符串字面量

短字符串：使用 `''` 或 `""` 的字面量，支持转义
- `-z` 结尾可以支持换行，该转义字符会删除自身及后面的一系列空白字符

```lua
str="hello \z
     world!"
print(str)
```

```go
var reShortStr = regexp.MustCompile(`(?s)(^'(\\\\|\\'|\\\n|\\z\s*|[^'\n])*')|(^"(\\\\|\\"|\\\n|\\z\s*|[^"\n])*")`)
```

长字符串：使用 `[<...>[字符串]<...>]`，两块 `<...>` 可空但必须相同

```lua
a=[[alo
123"]]
b=[==[
alo
123"]==]
print(a)
print("-----")
print(b)
```

长字符串关键在于识别长方括号

```go
var reOpeningLongBracket = regexp.MustCompile(`^\[=*\[`)
```
## 运算符、分隔符

运算符、分隔符都属于 Token
